<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discovery Log | Homeschool Command Center</title>
    <!-- Fonts: Inter (Clean Modern) and Space Grotesk (Futuristic) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Futuristic Dark Palette
                        void: '#0a0a0f',
                        surface: '#12121a',
                        card: '#1a1a24',
                        border: '#2a2a3a',
                        // Accent gradients
                        accent: '#8b5cf6', // Violet
                        accentAlt: '#06b6d4', // Cyan
                        glow: '#a78bfa',
                        // Text
                        textPrimary: '#f1f5f9',
                        textSecondary: '#94a3b8',
                        textMuted: '#64748b',
                        // Status
                        success: '#22c55e',
                        warning: '#f59e0b',
                        // Legacy mapping
                        passportBlue: '#8b5cf6',
                        sunshine: '#f59e0b',
                        skyBlue: '#1e293b',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        display: ['Space Grotesk', 'sans-serif'],
                        fun: ['Space Grotesk', 'sans-serif'],
                    },
                    boxShadow: {
                        glow: '0 0 20px rgba(139, 92, 246, 0.3)',
                        card: '0 4px 24px rgba(0, 0, 0, 0.4)',
                        inner: 'inset 0 1px 0 rgba(255,255,255,0.05)',
                    },
                    backdropBlur: {
                        glass: '16px',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #12121a 50%, #0f0f18 100%);
            min-height: 100vh;
        }
        h1, h2, h3, .font-display {
            font-family: 'Space Grotesk', sans-serif;
        }
        .glass {
            background: rgba(26, 26, 36, 0.7);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .gradient-text {
            background: linear-gradient(135deg, #8b5cf6 0%, #06b6d4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .btn-primary {
            @apply px-5 py-2.5 bg-gradient-to-r from-accent to-accentAlt text-white font-semibold rounded-xl shadow-glow hover:opacity-90 transition-all flex items-center gap-2;
        }
        .nav-btn {
            @apply px-4 py-2 rounded-xl font-medium text-textSecondary transition-all hover:bg-card hover:text-textPrimary;
        }
        .nav-btn.active {
            @apply bg-card text-textPrimary border border-border shadow-inner;
        }
        .view-section {
            animation: fadeIn 0.3s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(139, 92, 246, 0.15);
        }
        
        /* Modal Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes zoomIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .animate-in.fade-in {
            animation: fadeIn 0.2s ease-out forwards;
        }
        .animate-in.zoom-in-95 {
            animation: zoomIn 0.2s ease-out forwards;
        }
        
        /* File Input Styling */
        input[type="file"]::file-selector-button {
            display: none;
        }
    </style>
</head>
<body class="min-h-screen font-sans text-textPrimary">
    
    <!-- Header -->
    <header class="glass sticky top-0 z-50 border-b border-border">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center h-auto md:h-16 py-3 md:py-0 gap-3">
                <!-- Logo -->
                <div class="flex items-center gap-3 self-start md:self-auto">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-violet-500 to-cyan-500 flex items-center justify-center text-xl">
                        ‚ö°
                    </div>
                    <div>
                        <h1 class="text-xl font-display font-bold gradient-text tracking-tight">Discovery Log</h1>
                        <p class="text-[10px] text-textMuted font-medium tracking-widest uppercase">Command Center</p>
                    </div>
                </div>

                <!-- Navigation -->
                <nav class="flex gap-1 overflow-x-auto w-full md:w-auto" id="nav-tabs">
                    <button id="nav-dashboard" class="nav-btn active" data-view="dashboard">
                        <span>‚óé</span> <span class="hidden sm:inline">Roadmap</span>
                    </button>
                    <button id="nav-today" class="nav-btn" data-view="today">
                        <span>‚ò∞</span> <span class="hidden sm:inline">Daily</span>
                    </button>
                    <button id="nav-subjects" class="nav-btn" data-view="subjects">
                        <span>‚óà</span> <span class="hidden sm:inline">Skills</span>
                    </button>
                    <button id="nav-evidence" class="nav-btn" data-view="evidence">
                        <span>‚ó´</span> <span class="hidden sm:inline">Portfolio</span>
                    </button>
                    <button id="nav-transcript" class="nav-btn" data-view="transcript">
                        <span>‚óâ</span> <span class="hidden sm:inline">Docs</span>
                    </button>
                </nav>

                <!-- Profile Switcher -->
                <div class="flex items-center gap-2 self-end md:self-auto">
                    <div id="profile-switcher" class="flex gap-1 bg-surface p-1 rounded-xl border border-border">
                        <!-- Populated by profiles.js -->
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Mission Banner -->
    <div class="bg-gradient-to-r from-violet-900/30 to-cyan-900/30 border-b border-border py-2 px-4">
        <div class="max-w-5xl mx-auto flex items-center justify-center gap-3 text-center">
            <p class="font-medium text-sm text-textSecondary tracking-wide" id="mission-statement">
                <span class="text-accent">‚óÜ</span> Our Mission: Raise curious, creative, and capable world citizens <span class="text-accentAlt">‚óÜ</span>
            </p>
        </div>
    </div>

    <!-- Identity & Passport Stats -->
    <div id="progress-section" class="max-w-7xl mx-auto px-4 py-8">
        <div class="flex flex-col md:flex-row justify-between items-end gap-6">
            
            <!-- Passport Card -->
            <div class="flex items-center gap-5 bg-white p-4 pr-8 rounded-2xl border-2 border-skyBlue shadow-passport transform -rotate-1 hover:rotate-0 transition-transform duration-300">
                <div class="relative">
                    <div id="header-avatar" class="w-20 h-20 rounded-lg bg-sand border-4 border-white shadow-sm flex items-center justify-center text-5xl">
                        üßë‚ÄçüöÄ
                    </div>
                    <div class="absolute -top-2 -right-2 bg-sunshine text-passportBlue w-8 h-8 rounded-full flex items-center justify-center font-bold border-2 border-white shadow-sm transform rotate-12">
                        <span id="header-level">1</span>
                    </div>
                </div>
                <div>
                    <p class="text-xs font-bold text-sky-500 uppercase tracking-widest mb-0.5">Passport Holder</p>
                    <h2 id="header-username" class="text-3xl font-fun font-bold text-passportBlue leading-none">Explorer</h2>
                    
                    <div class="flex items-center gap-2 mt-2">
                        <div class="w-32 h-3 bg-gray-100 rounded-full overflow-hidden border border-gray-200">
                            <div id="header-xp-bar" class="h-full bg-gradient-to-r from-sunshine to-amber-500 w-0 transition-all duration-500"></div>
                        </div>
                        <span class="text-[10px] font-bold text-slate-400">XP</span>
                    </div>
                </div>
            </div>

            <!-- Streak Stamp -->
            <div class="transform rotate-2 group">
                <div class="bg-white px-5 py-3 rounded-xl border-2 border-dashed border-sunshine shadow-sm group-hover:shadow-md transition-all cursor-default">
                    <p class="text-[10px] text-amber-500 font-bold uppercase tracking-wider text-center mb-1">Travel Streak</p>
                    <div class="flex items-center gap-2 justify-center">
                        <span class="text-2xl animate-pulse">üî•</span>
                        <span id="streak-display" class="text-2xl font-fun font-bold text-passportBlue">0 Days</span>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-6">
        
        <!-- Roadmap View (New Dashboard) -->
        <section id="view-dashboard" class="view-section">
            <div class="mb-8 text-center pt-4">
                <h2 class="text-3xl md:text-4xl font-fun font-bold text-passportBlue mb-2">
                    Future Destinations
                </h2>
                <p class="text-slate-500">The journey ahead for our explorers.</p>
            </div>

            <!-- Destinations Grid -->
            <div id="destinations-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
                <!-- Injected by destinations.js -->
            </div>

            <!-- Timeline / Milestones (Static Mock for MVP) -->
            <div class="bg-white rounded-3xl shadow-card p-8 border-2 border-sky-100">
                <h3 class="text-xl font-fun font-bold text-passportBlue mb-6">üìÖ 2025 Flight Plan</h3>
                <div class="relative">
                    <div class="absolute left-4 top-0 bottom-0 w-0.5 bg-sky-200"></div>
                    
                    <div class="flex gap-4 items-start mb-8 relative">
                        <div class="w-8 h-8 rounded-full bg-sunshine border-4 border-white shadow-sm flex items-center justify-center z-10 text-xs">üöÄ</div>
                        <div>
                            <span class="text-xs font-bold text-sky-500 uppercase">Quarter 1</span>
                            <h4 class="text-lg font-bold text-deepOcean">Math Olympiad Prep</h4>
                            <p class="text-sm text-slate-500">Focus on algebraic concepts and speed logic.</p>
                        </div>
                    </div>

                    <div class="flex gap-4 items-start mb-8 relative">
                        <div class="w-8 h-8 rounded-full bg-skyBlue border-4 border-white shadow-sm flex items-center justify-center z-10 text-xs">üé≠</div>
                        <div>
                            <span class="text-xs font-bold text-sky-500 uppercase">Quarter 2</span>
                            <h4 class="text-lg font-bold text-deepOcean">Regional Theater Auditions</h4>
                            <p class="text-sm text-slate-500">Preparing 2 monologues and 1 song.</p>
                        </div>
                    </div>

                     <div class="flex gap-4 items-start relative opacity-50">
                        <div class="w-8 h-8 rounded-full bg-white border-4 border-slate-200 shadow-sm flex items-center justify-center z-10 text-xs">üèÅ</div>
                        <div>
                            <span class="text-xs font-bold text-slate-400 uppercase">Year End</span>
                            <h4 class="text-lg font-bold text-slate-500">Portfolio Review</h4>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Today View (Daily Log) -->
        <section id="view-today" class="view-section hidden">
            <div class="mb-6">
                <h2 class="text-xl md:text-2xl font-fun font-bold text-passportBlue mb-1">
                    Daily Log
                </h2>
                <p id="today-date" class="text-slate text-sm"></p>
            </div>
            <div id="today-lessons" class="space-y-3">
                <!-- Today's lessons will be rendered here -->
            </div>
            <div id="today-empty" class="empty-state hidden">
                <div class="text-6xl mb-4">üéâ</div>
                <h3 class="text-xl font-semibold text-charcoal mb-2">All done for today!</h3>
                <p class="text-slate">Enjoy your well-deserved break.</p>
            </div>
        </section>

        <!-- Week View -->
        <section id="view-week" class="view-section hidden">
            <div class="mb-6">
                <div class="flex items-center justify-between">
                    <h2 class="text-xl md:text-2xl font-cozy font-semibold text-charcoal">
                        Weekly Schedule
                    </h2>
                    <div class="flex gap-2">
                        <button id="prev-week" class="week-nav-btn">‚Üê Prev</button>
                        <button id="current-week" class="week-nav-btn">This Week</button>
                        <button id="next-week" class="week-nav-btn">Next ‚Üí</button>
                    </div>
                </div>
                <p id="week-range" class="text-slate text-sm mt-1"></p>
            </div>
            
            <!-- Weekly Grid -->
            <div class="week-grid">
                <div class="day-column" data-day="1">
                    <div class="day-header">Monday</div>
                    <div class="day-lessons" id="day-1-lessons"></div>
                </div>
                <div class="day-column" data-day="2">
                    <div class="day-header">Tuesday</div>
                    <div class="day-lessons" id="day-2-lessons"></div>
                </div>
                <div class="day-column" data-day="3">
                    <div class="day-header">Wednesday</div>
                    <div class="day-lessons" id="day-3-lessons"></div>
                </div>
                <div class="day-column" data-day="4">
                    <div class="day-header">Thursday</div>
                    <div class="day-lessons" id="day-4-lessons"></div>
                </div>
                <div class="day-column" data-day="5">
                    <div class="day-header">Friday</div>
                    <div class="day-lessons" id="day-5-lessons"></div>
                </div>
            </div>
        </section>

        <!-- Subjects View -->
        <section id="view-subjects" class="view-section hidden">
            <div class="mb-6">
                <h2 class="text-xl md:text-2xl font-cozy font-semibold text-charcoal">
                    Subject Setup
                </h2>
                <p class="text-slate text-sm">Manage your subjects and their colors</p>
            </div>

            <!-- Add Subject Form -->
            <div class="subject-form-card mb-6">
                <h3 class="font-semibold text-charcoal mb-4">Add New Subject</h3>
                <form id="add-subject-form" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-slate mb-1">Subject Name</label>
                            <input type="text" id="subject-name" required
                                   class="w-full px-3 py-2 rounded-lg border border-softPeach/50 bg-white focus:ring-2 focus:ring-terracotta/30 focus:border-terracotta transition-all"
                                   placeholder="e.g., Mathematics">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate mb-1">Color</label>
                            <div class="flex gap-2">
                                <input type="color" id="subject-color" value="#E07A5F"
                                       class="w-12 h-10 rounded-lg border border-softPeach/50 cursor-pointer">
                                <div class="flex gap-1 flex-wrap">
                                    <button type="button" class="color-preset" data-color="#E07A5F" style="background: #E07A5F"></button>
                                    <button type="button" class="color-preset" data-color="#A8C5A8" style="background: #A8C5A8"></button>
                                    <button type="button" class="color-preset" data-color="#A7C7E7" style="background: #A7C7E7"></button>
                                    <button type="button" class="color-preset" data-color="#C9B1D4" style="background: #C9B1D4"></button>
                                    <button type="button" class="color-preset" data-color="#F4D03F" style="background: #F4D03F"></button>
                                    <button type="button" class="color-preset" data-color="#E8B4B8" style="background: #E8B4B8"></button>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate mb-1">Assign to</label>
                            <select id="subject-child" required
                                    class="w-full px-3 py-2 rounded-lg border border-softPeach/50 bg-white focus:ring-2 focus:ring-terracotta/30 focus:border-terracotta transition-all">
                                <option value="1">Grade 4</option>
                                <option value="2">Grade 6</option>
                                <option value="both">Both Children</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn-primary">
                        ‚ûï Add Subject
                    </button>
                </form>
            </div>

            <!-- Quick Add Lessons -->
            <div class="subject-form-card mb-6">
                <h3 class="font-semibold text-charcoal mb-4">Quick Add Lessons</h3>
                <form id="add-lesson-form" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-slate mb-1">Subject</label>
                            <select id="lesson-subject" required
                                    class="w-full px-3 py-2 rounded-lg border border-softPeach/50 bg-white focus:ring-2 focus:ring-terracotta/30 focus:border-terracotta transition-all">
                                <option value="">Select subject...</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate mb-1">Lesson Title</label>
                            <input type="text" id="lesson-title" required
                                   class="w-full px-3 py-2 rounded-lg border border-softPeach/50 bg-white focus:ring-2 focus:ring-terracotta/30 focus:border-terracotta transition-all"
                                   placeholder="e.g., Chapter 5 Review">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate mb-1">Day</label>
                            <select id="lesson-day" required
                                    class="w-full px-3 py-2 rounded-lg border border-softPeach/50 bg-white focus:ring-2 focus:ring-terracotta/30 focus:border-terracotta transition-all">
                                <option value="1">Monday</option>
                                <option value="2">Tuesday</option>
                                <option value="3">Wednesday</option>
                                <option value="4">Thursday</option>
                                <option value="5">Friday</option>
                            </select>
                        </div>
                        <div class="flex items-end">
                            <button type="submit" class="btn-primary w-full">
                                ‚ûï Add Lesson
                            </button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Math Progress Chart (Produce Only) -->
            <div id="math-progress-container" class="subject-form-card mb-6 hidden">
                <h3 class="font-semibold text-charcoal mb-4 flex items-center gap-2">
                    üìä Math Progress Tracker
                    <span class="text-xs font-normal text-slate bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded-full">Game Design Track</span>
                </h3>
                <div class="h-64 w-full">
                    <canvas id="mathChart"></canvas>
                </div>
            </div>

            <!-- Subject Lists -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-semibold text-charcoal mb-3 flex items-center gap-2">
                        <span class="w-6 h-6 rounded-full bg-sky flex items-center justify-center text-xs text-white font-bold">G4</span>
                        Grade 4 Subjects
                    </h3>
                    <div id="subjects-child-1" class="space-y-2">
                        <!-- Subjects will be rendered here -->
                    </div>
                </div>
                <div>
                    <h3 class="font-semibold text-charcoal mb-3 flex items-center gap-2">
                        <span class="w-6 h-6 rounded-full bg-lavender flex items-center justify-center text-xs text-white font-bold">G6</span>
                        Grade 6 Subjects
                    </h3>
                    <div id="subjects-child-2" class="space-y-2">
                        <!-- Subjects will be rendered here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Evidence Locker View -->
        <section id="view-evidence" class="view-section hidden">
            <div class="mb-6 flex justify-between items-center">
                <div>
                    <h2 class="text-xl md:text-2xl font-cozy font-semibold text-charcoal">Evidence Locker</h2>
                    <p class="text-slate text-sm">Portfolio of "Best Work" and projects</p>
                </div>
                <button id="add-evidence-btn" class="btn-primary">
                    üì∏ Upload Work
                </button>
            </div>
            
            <!-- Filters -->
            <div class="flex gap-2 overflow-x-auto pb-2 mb-6" id="evidence-filters">
                <button class="px-3 py-1 rounded-full bg-terracotta text-white text-sm font-medium">All</button>
                <button class="px-3 py-1 rounded-full bg-white border border-softPeach text-slate text-sm hover:border-terracotta">Best Work</button>
                <button class="px-3 py-1 rounded-full bg-white border border-softPeach text-slate text-sm hover:border-terracotta">Math</button>
                <button class="px-3 py-1 rounded-full bg-white border border-softPeach text-slate text-sm hover:border-terracotta">Projects</button>
            </div>

            <div id="evidence-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Evidence items will be rendered here -->
                <div class="text-slate italic col-span-full text-center py-12">
                    No evidence items yet. Upload some work!
                </div>
            </div>
        </section>

        <!-- Transcript View -->
        <section id="view-transcript" class="view-section hidden">
            <div class="mb-6 flex justify-between items-center">
                <div>
                    <h2 class="text-xl md:text-2xl font-cozy font-semibold text-charcoal">Transcript</h2>
                    <p class="text-slate text-sm">Official homeschool academic record</p>
                </div>
                <button id="generate-pdf-btn" class="btn-primary bg-sage hover:bg-forest">
                    ‚¨áÔ∏è Download PDF
                </button>
            </div>

            <!-- Transcript Preview -->
            <div id="transcript-preview" class="bg-white p-8 shadow-lg rounded-sm max-w-3xl mx-auto border border-softPeach">
                <!-- Dynamic Content -->
                <div class="text-center border-b-2 border-charcoal pb-6 mb-6">
                    <h1 class="text-3xl font-serif font-bold text-charcoal mb-2">OFFICIAL HIGH SCHOOL TRANSCRIPT</h1>
                    <div class="flex justify-between text-sm mt-4 px-12">
                        <div class="text-left">
                            <p class="font-bold">Student Information</p>
                            <p id="t-student-name">Name: Faye</p>
                            <p id="t-student-dob">DOB: 01/01/2012</p>
                            <p id="t-student-id">Student ID: HS-2025-001</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold">School Information</p>
                            <p>Cozy Homeschool Academy</p>
                            <p>123 Learning Lane</p>
                            <p>Parent/Admin: Monica</p>
                        </div>
                    </div>
                </div>

                <div id="transcript-courses">
                    <!-- Courses Table -->
                </div>

                <div class="mt-8 flex justify-end">
                    <div class="bg-softPeach/30 p-4 rounded border border-softPeach">
                        <p class="font-bold text-lg">Cumulative GPA: <span id="t-gpa">4.0</span></p>
                        <p class="">Total Credits: <span id="t-credits">0</span></p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden">
        <span id="toast-message"></span>
    </div>

    <!-- Celebration Overlay -->
    <div id="celebration" class="celebration-overlay hidden">
        <div class="celebration-content">
            <div class="text-8xl mb-4">üéâ</div>
            <h2 class="text-3xl font-cozy font-bold text-charcoal">Amazing!</h2>
            <p class="text-slate">100% complete for the week!</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/state.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/profiles.js"></script>
    <script src="js/gamification.js"></script>
    <script src="js/evidence.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/destinations.js"></script>
    <script src="js/subjects.js"></script>
    <script src="js/schedule.js"></script>
    <script src="js/reschedule.js"></script>
    <script src="js/progress.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
